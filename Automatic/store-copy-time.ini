[Command]
Command="
    'use strict';

    const mimeTags = 'application/x-copyq-tags';

    function setSelectionTime() {
        const sel = ItemSelection().current();
        if (sel.length !== 1) { return; }

        const oldTags = sel.itemsFormat(mimeTags);
        if (oldTags.length !== 1) { return; }

        const oldTag = str(oldTags[0] || '');
        const time = dateString('yyyy-MM-dd hh:mm:ss');
        if (oldTag.includes(time)) { return; }

        const keepTags = oldTag.replace(/\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}/, '');
        const tags = `${keepTags}, ${time}`;
        sel.setItemsFormat(mimeTags, tags);
    }

    const onItemsAdded_ = onItemsAdded;
    onItemsAdded = function() {
        setSelectionTime();
        return onItemsAdded_();
    };

    const onItemsChanged_ = onItemsChanged;
    onItemsChanged = function() {
        setSelectionTime();
        return onItemsChanged_();
    };"
Icon=ï€—
IsScript=true
Name=Show Copy Time
